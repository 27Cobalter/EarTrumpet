<Window x:Class="EarTrumpet.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:p="clr-namespace:EarTrumpet.Properties"
        xmlns:viewModels="clr-namespace:EarTrumpet.ViewModels"
        xmlns:ext="clr-namespace:EarTrumpet.Extensions"
        xmlns:local="clr-namespace:EarTrumpet"
        Title="EarTrumpet"
        MaxHeight="600"
        Width="360"
        Icon="Application.ico"
        Topmost="True"
        ShowInTaskbar="False"
        AllowsTransparency="True"
        SnapsToDevicePixels="True"
        UseLayoutRounding="True"
        WindowStyle="None"
        Deactivated="Window_Deactivated"
        PreviewKeyDown="Window_PreviewKeyDown"
        Foreground="{DynamicResource WindowForeground}"
        Background="{DynamicResource WindowBackground}"
		ResizeMode="NoResize"
        TextOptions.TextFormattingMode="Display"
        x:Name="VolumeWindow">
    <Window.Resources>

        <ext:OpacityConverter x:Key="opacityConverter" />
        <ext:InvertableVisibilityConverter x:Key="visConverter" />

        <SolidColorBrush x:Key="WindowForeground"
                         Color="White" />
        <SolidColorBrush x:Key="WindowBackground"
                         Color="Black" />
        <SolidColorBrush x:Key="CottonSwabSliderTrackBackground"
                         Color="#39FFFFFF" />
        <SolidColorBrush x:Key="CottonSwabSliderThumb"
                         Color="#FF339933" />
        <SolidColorBrush x:Key="HeaderBackground"
                         Color="Black" />
        <SolidColorBrush x:Key="CottonSwabSliderThumbHover"
                         Color="Red" />
        <SolidColorBrush x:Key="CottonSwabSliderThumbPressed"
                         Color="Yellow" />
        <SolidColorBrush x:Key="CottonSwabSliderTrackFill"
                         Color="#FF339933" />

    </Window.Resources>

    <ScrollViewer x:Name="LayoutRoot"
                    VerticalScrollBarVisibility="Auto"
                    CanContentScroll="True"
                    PanningMode="VerticalOnly"
                    Focusable="False"                      
                    Margin="0">
        <HeaderedItemsControl ItemsSource="{Binding Apps, Mode=OneWay}"
                        Header="{Binding Device}"
                        ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                        HorizontalContentAlignment="Stretch"
                        Focusable="False">
            <HeaderedItemsControl.Template>
                <ControlTemplate TargetType="HeaderedItemsControl">
                    <Grid x:Name="Root">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <ContentControl Content="{TemplateBinding Header}" KeyboardNavigation.IsTabStop="False" ContentTemplate="{TemplateBinding HeaderTemplate}" HorizontalAlignment="Stretch" Visibility="{Binding DeviceVisibility}" />
                        <ItemsPresenter x:Name="Items" Grid.Row="1" Margin="0,0,0,12" Visibility="{Binding ListVisibility}" />
                        <Grid x:Name="NoAppsPanel"
                                Margin="0,8"
                                Grid.Row="1" 
                                Height="50"
                                Visibility="{Binding NoAppsPaneVisibility}">
                            <TextBlock Text="{Binding NoItemsContent}"
                                    VerticalAlignment="Center"
                                    HorizontalAlignment="Center"
                                    FontSize="{DynamicResource {x:Static SystemFonts.MessageFontSizeKey}}"
                                    TextWrapping="Wrap" />
                        </Grid>
                    </Grid>
                </ControlTemplate>
            </HeaderedItemsControl.Template>
            <HeaderedItemsControl.HeaderTemplate>
                <DataTemplate DataType="viewModels:DeviceAppItemViewModel">
                    <Border Background="{DynamicResource HeaderBackground}"
                            BorderThickness="0,0,0,12">
                        <local:VolumeControlChannel 
                            DisplayName="{Binding DisplayName}"
                            IsMuted="{Binding IsMuted,Mode=TwoWay}"
                            Volume="{Binding Volume,Mode=TwoWay}"
                            IconHeight="32"
                            IconWidth="32"
                            VolumeTextFontSize="24"
                            IconText="&#xE767;"
                            IconTextSize="24"
                            IconTextFontFamily="Segoe MDL2 Assets"
                            Background="{Binding Background}"
                            PeakValue="{Binding PeakValue}"
                            BeepOnPointerUp="True"
                            Padding="0,4,0,4"
                        />
                    </Border>
                </DataTemplate>
            </HeaderedItemsControl.HeaderTemplate>
            <ItemsControl.ItemTemplate>
                <DataTemplate DataType="viewModels:AppItemViewModel">
                    <local:VolumeControlChannel 
                        DisplayName="{Binding DisplayName}"
                        IsMuted="{Binding IsMuted,Mode=TwoWay}"
                        Volume="{Binding Volume,Mode=TwoWay}"
                        IconHeight="24"
                        IconWidth="24"
                        VolumeTextFontSize="18"
                        IconSource="{Binding Icon}"
                        IconText="{Binding IconText}"
                        IconTextSize="16"
                        IconTextFontWeight="Bold"
                        IconTextFontFamily="{Binding RelativeSource={RelativeSource Self},Path=FontFamily}"
                        Background="{Binding Background}"
                        PeakValue="{Binding PeakValue}"
                        />
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </HeaderedItemsControl>
    </ScrollViewer>
</Window>
